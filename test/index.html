<!DOCTYPE html>
<html>
<head>
  <script id='requests'>
    var requests = {"query":{"post":{"method":"POST","url":"/user/5/21?q1=2&q2=t"},"put":{"method":"PUT","url":"/user/admin?q1=3&q2=t"},"del":{"method":"DELETE","url":"/user/5?q1=3&q2=t"},"get":{"method":"GET","url":"/user/5/age?q1=3&q2=t"}},"params":{"post":{"method":"POST","url":"/user/5/21"},"put":{"method":"PUT","url":"/user/admin"},"del":{"method":"DELETE","url":"/user/5"},"get":{"method":"GET","url":"/user/5/age"}},"routing":{"post":{"method":"POST","url":"/"},"put":{"method":"PUT","url":"/"},"del":{"method":"DELETE","url":"/"},"get":{"method":"GET","url":"/"}}}
  </script>
  <script id='routes'>
    var routes = {"get":{"/user/:id/age":"get./user/:id/age","/":"get./"},"post":{"/user/:id/:age":"post./user/:id/:age","/":"post./"},"put":{"/:type/:subtype":"put./:type/:subtype","/":"put./"},"delete":{"/user/:id":"delete./user/:id","/":"delete./"}}
  </script>
</head>
<body>
  <script src='../build/build.js' type='application/javascript'></script>
  <script>
    var assert = require('component-assert')
    var mr = require('match-route')
        
    // ROUTING
    var on = {};
    
    on.post = function (route, params, query) {
      assert(Object.keys(params).length === 0);
      assert(Object.keys(query).length === 0);
      assert(route === 'post./');
    };
    
    on.del = function (route, params, query) {
      assert(Object.keys(params).length === 0);
      assert(Object.keys(query).length === 0);
      assert(route === 'delete./');
    };
    
    on.get = function (route, params, query) {
      assert(Object.keys(params).length === 0);
      assert(Object.keys(query).length === 0);
      assert(route === 'get./');
    };
    
    on.put = function (route, params, query) {
      assert(Object.keys(params).length === 0);
      assert(Object.keys(query).length === 0);
      assert(route === 'put./');
    };
    
    mr(requests.routing.post, routes, on.post);
    mr(requests.routing.get, routes, on.get);
    mr(requests.routing.del, routes, on.del);
    mr(requests.routing.put, routes, on.put);
    
    
    
    // PARAMS
    on = {};
    
    on.post = function (route, params, query) {
      assert(Object.keys(params).length === 2);
      assert(Object.keys(query).length === 0);
      assert(route === 'post./user/:id/:age');
      assert(params.age === '21');
      assert(params.id === '5');
    };
    
    on.del = function (route, params, query) {
      assert(Object.keys(params).length === 1);
      assert(Object.keys(query).length === 0);
      assert(route === 'delete./user/:id');
      assert(params.id === '5');
    };
    
    on.get = function (route, params, query) {
      assert(Object.keys(params).length === 1);
      assert(Object.keys(query).length === 0);
      assert(route === 'get./user/:id/age');
      assert(params.id === '5');
    };
    
    on.put = function (route, params, query) {
      assert(Object.keys(params).length === 2);
      assert(Object.keys(query).length === 0);
      assert(route === 'put./:type/:subtype');
      assert(params.subtype === 'admin');
      assert(params.type === 'user');
    };
    
    mr(requests.params.post, routes, on.post);
    mr(requests.params.get, routes, on.get);
    mr(requests.params.del, routes, on.del);
    mr(requests.params.put, routes, on.put);
    
    
    
    // QUERYS
    on = {};
      
    on.post = function (route, params, query) {
      assert(Object.keys(params).length === 2);
      assert(Object.keys(query).length === 2);
      assert(route === 'post./user/:id/:age');
      assert(params.age === '21');
      assert(params.id === '5');
      assert(query.q1 === '2');
      assert(query.q2 === 't');
    };
    
    on.del = function (route, params, query) {
      assert(Object.keys(params).length === 1);
      assert(Object.keys(query).length === 2);
      assert(route === 'delete./user/:id');
      assert(params.id === '5');
      assert(query.q1 === '3');
      assert(query.q2 === 't');
    };
    
    on.get = function (route, params, query) {
      assert(Object.keys(params).length === 1);
      assert(Object.keys(query).length === 2);
      assert(route === 'get./user/:id/age');
      assert(params.id === '5');
      assert(query.q1 === '3');
      assert(query.q2 === 't');
    };
    
    on.put = function (route, params, query) {
      assert(Object.keys(params).length === 2);
      assert(Object.keys(query).length === 2);
      assert(route === 'put./:type/:subtype');
      assert(params.subtype === 'admin');
      assert(params.type === 'user');
      assert(query.q1 === '3');
      assert(query.q2 === 't');
    };
    
    mr(requests.query.post, routes, on.post);
    mr(requests.query.get, routes, on.get);
    mr(requests.query.del, routes, on.del);
    mr(requests.query.put, routes, on.put);
    
  </script>
</body>
</html>